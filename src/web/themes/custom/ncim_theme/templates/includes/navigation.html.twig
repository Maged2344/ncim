{#
/**
 * @file
 * Navigation template with mega menu and mobile offcanvas.
 */
#}
<nav class="navbar navbar-expand-xl navbar-light bg-white">
  <div class="outer-container d-flex align-items-center">
    <!-- Logo -->
    <a class="navbar-brand m-0" href="{{ path('<front>') }}">
      <img src="{{ base_path ~ directory }}/images/ncim.png" alt="NCIM Logo" title="المركز الوطني لتفتيش والرقابة" style="height:auto; max-height:60px;">
    </a>

    <!-- Toggler -->
    <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Nav Links -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{{ path('<front>') }}">الرئيسية</a>
        </li>
        <li class="nav-item dropdown position-static">
          <a class="nav-link gap-2" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            عن المركز <img src="{{ base_path ~ directory }}/images/icons/arrow_down.svg">
          </a>
          <ul class="dropdown-menu w-100 bg-white mega-menu" aria-labelledby="navbarDropdown">
            <div class="outer-container">
              <div class="row g-4 row-cols-4">
                <div>
                  <h6 class="fw-bold px-3 mb-2 text-primary">عن المركز</h6>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/check.svg">
                    <span>نبذة عن المركز</span>
                  </a>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/stucture.svg">
                    <span>الهيكل التنظيمي</span>
                  </a>
                </div>
                <div>
                  <h6 class="fw-bold px-3 mb-2 text-primary">من نخدم</h6>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/bussiness.svg">
                    <span>أصحاب العمل والأفراد</span>
                  </a>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/gov.svg">
                    <span>الجهات الحكومية والمنفذة</span>
                  </a>
                </div>
                <div>
                  <h6 class="fw-bold px-3 mb-2 text-primary">الأنظمة والمصطلحات</h6>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/ins.svg">
                    <span>الأنظمة واللوائح</span>
                  </a>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/dictionary.svg">
                    <span>المصطلحات</span>
                  </a>
                </div>
                <div>
                  <h6 class="fw-bold px-3 mb-2 text-primary">الشفافية والحوكمة</h6>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/chart.svg">
                    <span>التقارير السنوية</span>
                  </a>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/policy.svg">
                    <span>سياسة الخصوصية</span>
                  </a>
                  <a class="dropdown-item d-flex gap-3 align-items-center" href="#">
                    <img src="{{ base_path ~ directory }}/images/icons/freedom.svg">
                    <span>حرية الحصول على المعلومات</span>
                  </a>
                </div>
              </div>
            </div>
          </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">الأخبار والأحداث</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">الخدمات</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">المساعدة والدعم</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">تواصل معنا</a>
        </li>
      </ul>

      <!-- Search Form -->
      <div class="d-flex navbar-nav gap-3">
        <button class="btn border-0" type="button" title="Search">
          <img src="{{ base_path ~ directory }}/images/icons/search.svg" alt="Search">
        </button>
        
        <!-- Language Switcher -->
        {% if languages is defined and languages|length >= 1 %}
        <div class="dropdown">
          <a class="nav-link" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
            {{ other_language_name|default('English') }}
          </a>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            {% for language in languages %}
              {% if language.url %}
                <li><a class="dropdown-item" href="{{ language.url }}">{{ language.name }}</a></li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
        {% else %}
        <!-- Debug: Show what's available -->
        <div class="dropdown">
          <a class="nav-link" type="button" id="dropdownMenuButton" data-bs-toggle="offcanvas" aria-expanded="false">
            Debug: {{ debug_language_count|default('No count') }} langs
          </a>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <li><a class="dropdown-item" href="#">Current: {{ debug_current_language|default('Unknown') }}</a></li>
            <li><a class="dropdown-item" href="#">Languages defined: {{ languages is defined ? 'Yes' : 'No' }}</a></li>
            <li><a class="dropdown-item" href="#">Languages count: {{ languages|length|default('0') }}</a></li>
            {% if languages is defined %}
              {% for language in languages %}
                <li><a class="dropdown-item" href="#">{{ language.name|default('No name') }} - {{ language.id|default('No ID') }}</a></li>
              {% endfor %}
            {% endif %}
          </ul>
        </div>
        {% endif %}
        
        <!-- User Account Links -->
        
        <div class="d-flex align-items-center">
          {% if user.isAnonymous %}
            <!-- Not logged in - Show Login/Register -->
            <a href="{{ path('user.login') }}" class="btn btn-background-black-default me-2">تسجيل الدخول</a>
          {% else %}
            <!-- Logged in - Show User Menu -->
            <div class="dropdown btn btn-background-black-default me-2">
              <a class="nav-link dropdown-toggle text-light" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                {{ user.displayname|default(user.name.value) }}
              </a>
              <ul class="dropdown-menu" aria-labelledby="userDropdown">
                <li><a class="dropdown-item" href="{{ path('user.page') }}">الملف الشخصي</a></li>
                <li><a class="dropdown-item" href="{{ path('user.logout') }}">تسجيل الخروج</a></li>
              </ul>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</nav>

